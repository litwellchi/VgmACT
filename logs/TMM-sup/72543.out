04/23 [14:33:17] INFO     | >> [*] CogACT-VLA Training ::    train_vgmvla.py:127
                          Warming Up                                            
                 INFO     | >>     |=> "Do or do not; there  train_vgmvla.py:146
                          is no try."                                           
04/23 [14:33:24] INFO     | >> [*] Loading Base VLM          train_vgmvla.py:162
                          `prism-dinosiglip-224px+7b` from                      
                          ID/Path                                               
                 INFO     | >> [*] Loading VLA Checkpoint    train_vgmvla.py:169
                 INFO     | >> [*] Loading from local checkpoint     load.py:237
                          path                                                  
                          `/aifs4su/mmcode/worldm/RoboCrafter/save_c            
                          heckpoints/ww_training_128_4frame_v1.0_rt1            
                          _real_4frame/checkpoints/trainstep_checkpo            
                          ints/epoch=53-step=12000.ckpt`                        
                 INFO     | >> [*] Found Config =>> Loading &        load.py:262
                          Freezing with:                                        
                                       Checkpoint Path =>>                      
                          `/aifs4su/mmcode/worldm/RoboCrafter/save_c            
                          heckpoints/ww_training_128_4frame_v1.0_rt1            
                          _real_4frame/checkpoints/trainstep_checkpo            
                          ints/epoch=53-step=12000.ckpt`                        
                 INFO     | >> [*] Loading Video Generation Backbone load.py:269
                          from Checkpoint                                       
                 INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
04/23 [14:33:24] INFO     | >> LatentVisualDiffusion: Running in    ddpm3d.py:75
                          v-prediction mode                                     
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
04/23 [14:33:33] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:33] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:33] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:33] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:33] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:33] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
AE working on z of shape (1, 4, 16, 16) = 1024 dimensions.
04/23 [14:33:35] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:35] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:39] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:39] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:39] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:39] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:39] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:39] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:40] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:41] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:43] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:43] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:43] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:44] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:44] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:44] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:44] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:45] INFO     | >> Loaded ViT-H-14 model config.      factory.py:158
04/23 [14:33:49] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:49] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:49] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:49] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:50] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:50] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:50] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
04/23 [14:33:50] INFO     | >> Loading pretrained ViT-H-14        factory.py:206
                          weights (laion2b_s32b_b79k).                          
>>> model checkpoint loaded.
>>> model checkpoint loaded.
>>> model checkpoint loaded.
>>> model checkpoint loaded.
>>> model checkpoint loaded.
>>> model checkpoint loaded.
>>> model checkpoint loaded.
>>> model checkpoint loaded.
04/23 [14:34:05] INFO     | >> [*]  ===== Loading  Video        vgmactvla.py:118
                          Generation Model  ====                                
                          Found Config =>> Loading Video                        
                          Generation Model config from                          
                          /aifs4su/mmcode/worldm/RoboCrafter/sa                 
                          ve_checkpoints/ww_training_128_4frame                 
                          _v1.0_rt1_real_4frame/configs/model.y                 
                          aml with:                                             
                                       Checkpoint Path =>>                      
                          `/aifs4su/mmcode/worldm/RoboCrafter/s                 
                          ave_checkpoints/ww_training_128_4fram                 
                          e_v1.0_rt1_real_4frame/checkpoints/tr                 
                          ainstep_checkpoints/epoch=53-step=120                 
                          00.ckpt` Running VGM backbone (if                     
                          training) in =>> `freeze`                             
                 INFO     | >> [*] Loading Video Generation Action   load.py:275
                          Model from Checkpoint                                 
04/23 [14:34:06] INFO     | >> [*] Using pretrained action      vgmactvla.py:657
                          model from                                            
                          /aifs4su/mmcode/worldm/videoact/CogAC                 
                          T/CogACT-Base/checkpoints/CogACT-Base                 
                          .pt                                                   
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
04/23 [14:34:32] INFO     | >> [*] # Parameters (in          train_vgmvla.py:243
                          millions): 2822.840 Total, 213.907                    
                          Trainable                                             
                 INFO     | >> [*] Creating VLA Open-X       train_vgmvla.py:247
                          Dataset with Mixture                                  
                          `fractal20220817_data`                                
                 INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
04/23 [14:34:32] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          all, from                                             
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> [*] Loading existing dataset    data_utils.py:208
                          statistics from                                       
                          /aifs4su/mmcode/worldm/open_x_embodi                  
                          ment/oxe/fractal20220817_data/0.1.0/                  
                          dataset_statistics_10b89b791254a2a2f                  
                          a09cb2a3a4d4aae0138f22524132a4da6047                  
                          dc9918e7ec9.json.                                     
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:33] INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################


######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> [*] Threads per Dataset: [1]       dataset.py:537
                 INFO     | >> [*] Reads per Dataset: [1]         dataset.py:538
04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> [*] Constructing datasets...       dataset.py:541
                 INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 

######################################################################################
# Loading the following 1 datasets (incl. sampling weight):                         #
# fractal20220817_data: ====================================================1.000000 #
######################################################################################

04/23 [14:34:34] INFO     | >> Load dataset info from        dataset_info.py:599
                          /aifs4su/mmcode/worldm/open_x_embo                    
                          diment/oxe/fractal20220817_data/0.                    
                          1.0                                                   
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
                 INFO     | >> Constructing tf.data.Dataset logging_logger.py:49
                          fractal20220817_data for split                        
                          train, from                                           
                          /aifs4su/mmcode/worldm/open_x_emb                     
                          odiment/oxe/fractal20220817_data/                     
                          0.1.0                                                 
04/23 [14:34:35] INFO     | >> [*] Applying frame transforms on   dataset.py:583
                          dataset...                                            
                 INFO     | >> [*] Saved dataset statistics    data_utils.py:293
                          file at path                                          
                          /aifs4su/mmcode/worldm/videoact/VgmA                  
                          CT/0422V27_DiTB_freeze_reuseAct_128v                  
                          gm4f_rt1_20250423_143213--image_aug/                  
                          dataset_statistics.json                               
04/23 [14:34:36] INFO     | >> [*] Initializing Train        train_vgmvla.py:268
                          Strategy `fsdp-full-shard`                            
04/23 [14:34:40] INFO     | >> [*] FSDP Full-Shard Strategy =>>  fsdp_vgm.py:291
                          Finalized Training Setup:                             
                                   |-> Global (Effective) Batch                 
                          Size = 8192                                           
                                   |-> Per-Device Batch Size =                  
                          1024                                                  
                                   |-> Distributed World Size =                 
                          8                                                     
                                   |-> Gradient Accumulation                    
                          Steps = 1                                             
                                                                                
                                   |-> LLM Backbone FSDP                        
                          Gradient Checkpointing = True                         
                                   |-> Use FSDP Mixed Precision                 
                          = True                                                
                                           |-> Parameter                        
                          Precision = torch.bfloat16                            
                                           |-> Reduction                        
                          Precision = torch.float32                             
                                           |-> Buffer Precision                 
                          = torch.float32                                       
                                                                                
                                   |-> Default AdamW LR = 2e-05                 
                                   |-> AdamW Weight Decay = 0.0                 
                                   |-> LR Scheduler Type =                      
                          constant                                              
                                   |-> LR Scheduler Warmup Steps                
                          (Ratio) = 0 (0.0)                                     
                                   |-> Dataset Size = 3792896                   
                          Examples                                              
                                   |-> Max Steps = 4630000                      
                                                                                
                 INFO     | >> [*] Creating Metrics with     train_vgmvla.py:293
                          Active Trackers => `('jsonl',                         
                          'wandb')`                                             
04/23 [14:34:42] INFO     | >> [*] Starting VLA Training     train_vgmvla.py:306
                          Loop                                                  
                 INFO     | >> [*] ===  trainable paramater     vgmactvla.py:689
                          {'vgm.image_compressor',                              
                          'vgm.lang_compressor',                                
                          'vgm.projection', 'action_model.net'}                 
                          ===                                                   
Optimizer state dict keys:Optimizer state dict keys:Optimizer state dict keys:Optimizer state dict keys:Optimizer state dict keys: Optimizer state dict keys: Optimizer state dict keys: Optimizer state dict keys:  dict_keys(['state', 'param_groups']) dict_keys(['state', 'param_groups']) dict_keys(['state', 'param_groups'])dict_keys(['state', 'param_groups'])
dict_keys(['state', 'param_groups'])dict_keys(['state', 'param_groups'])

dict_keys(['state', 'param_groups'])



 dict_keys(['state', 'param_groups'])
04/26 [08:26:13] INFO     | >> [*] Saved optimizer state dict to fsdp_vgm.py:154
                          /aifs4su/mmcode/worldm/videoact/VgmACT                
                          /0422V27_DiTB_freeze_reuseAct_128vgm4f                
                          _rt1_20250423_143213--image_aug/checkp                
                          oints/step-015000-epoch-32-loss=0.0599                
                          .optimizer                                            
